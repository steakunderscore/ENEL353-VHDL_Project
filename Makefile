# Makefile automatically generated by ghdl
# Version: GHDL 0.29 (20100109) [Sokcho edition] - GCC back-end code generator
# Command used to generate this makefile:
# /usr/lib/ghdl/bin/ghdl --gen-makefile --ieee=mentor alu_tb

GHDL=ghdl
GHDLFLAGS= --ieee=synopsys
#GHDLFLAGS= --ieee=mentor

# Default target
all: alu_tb alu cpu IO microprocessor mmu

.PHONY: cleanall
cleanall: clean
	rm -f alu_tb alu gpr_tb gpr pc spr_tb sr fulladder dulladder8_tb mmu_main mmu_tb *.cf *.lst

.PHONY: clean
clean:
	rm -f *.o

# Elaboration target
alu_tb: alu.o alu_tb.o
	$(GHDL) -e $(GHDLFLAGS) $@

alu: alu.o
	$(GHDL) -e $(GHDLFLAGS) $@

cpu: cpu.o
	$(GHDL) -e $(GHDLFLAGS) $@processor/cpu.vhd

cu: cu.o
	$(GHDL) -e $(GHDLFLAGS) $@

data_tb: data_tb.o mmu_main.o txt_util.o IO.o
	$(GHDL) -e $(GHDLFLAGS) $@

fulladder8_tb: fulladder.o fulladder_tb.o
	$(GHDL) -e $(GHDLFLAGS) $@

fulladder: fulladder.o
	$(GHDL) -e $(GHDLFLAGS) $@

gpr_tb: gpr.o gpr_tb.o
	$(GHDL) -e $(GHDLFLAGS) $@

gpr: gpr.o reg.o
	$(GHDL) -e $(GHDLFLAGS) $@

IO: IO.o
	$(GHDL) -e $(GHDLFLAGS) $@

microprocessor: microprocessor.o
	$(GHDL) -e $(GHDLFLAGS) $@

mmu_main: mmu_main.o mmu_types.o control_unit.o minimal_uart_core.o header_builder.o header_decoder.o reg.o
	$(GHDL) -e $(GHDLFLAGS) $@

mmu_tb: mmu_tb.o mmu_main.o txt_util.o
	$(GHDL) -e $(GHDLFLAGS) $@

pc: spr.o reg.o
	$(GHDL) -e $(GHDLFLAGS) $@

spr_tb: spr.o spr_tb.o
	$(GHDL) -e $(GHDLFLAGS) $@

sr: spr.o reg.o
	$(GHDL) -e $(GHDLFLAGS) $@

reg: reg.o
	$(GHDL) -e $(GHDLFLAGS) $@

# Targets to analyze files
alu_tb.o: processor/alu_tb.vhd alu.o
	$(GHDL) -a $(GHDLFLAGS) $<

alu.o: processor/alu.vhd fulladder.o
	$(GHDL) -a $(GHDLFLAGS) $<

br_generator.o: mmu/muart/BRG.vhd
	$(GHDL) -a $(GHDLFLAGS) $<

control_unit.o: mmu/control_unit.vhd mmu_types.o data_control_unit.o inst_control_unit.o
	$(GHDL) -a $(GHDLFLAGS) $<

cpu.o: processor/cpu.vhd
	$(GHDL) -a $(GHDLFLAGS) $<

cu.o: processor/cu.vhd fulladder.o
	$(GHDL) -a $(GHDLFLAGS) $<

data_tb.o: data_tb.vhd mmu_main.o IO.o
	$(GHDL) -a $(GHDLFLAGS) $<

data_control_unit.o: mmu/data_control_unit.vhd mmu_types.o
	$(GHDL) -a $(GHDLFLAGS) $<

debounce.o: IO/debounce.vhd
	$(GHDL) -a $(GHDLFLAGS) $<

fulladder_tb.o: processor/fulladder_tb.vhd fulladder.o
	$(GHDL) -a $(GHDLFLAGS) $<

fulladder.o: processor/fulladder.vhd
	$(GHDL) -a $(GHDLFLAGS) $<

gpr_tb.o: processor/gpr_tb.vhd gpr.o
	$(GHDL) -a $(GHDLFLAGS) $<

gpr.o: processor/gpr.vhd reg.o
	$(GHDL) -a $(GHDLFLAGS) $<

header_builder.o: mmu/header_builder.vhd
	$(GHDL) -a $(GHDLFLAGS) $<

header_decoder.o: mmu/header_decoder.vhd
	$(GHDL) -a $(GHDLFLAGS) $<

inst_control_unit.o: mmu/inst_control_unit.vhd mmu_types.o
	$(GHDL) -a $(GHDLFLAGS) $<

IO.o: IO/IO.vhd debounce.o switch_reg.o led_io.o
	$(GHDL) -a $(GHDLFLAGS) $<

led_io.o: IO/leds.vhd
	$(GHDL) -a $(GHDLFLAGS) $<

microprocessor.o: microprocessor.vhd
	$(GHDL) -a $(GHDLFLAGS) $<

minimal_uart_core.o: mmu/muart/serial.vhd br_generator.o
	$(GHDL) -a $(GHDLFLAGS) $<

mmu_main.o: mmu/mmu.vhd mmu_types.o control_unit.o minimal_uart_core.o header_builder.o header_decoder.o reg.o
	$(GHDL) -a $(GHDLFLAGS) $<

mmu_tb.o: mmu/mmu_tb.vhd mmu_main.o txt_util.o
	$(GHDL) -a $(GHDLFLAGS) $<

mmu_types.o: mmu/mmu_types.vhd
	$(GHDL) -a $(GHDLFLAGS) $<

spr_tb.o: processor/spr_tb.vhd spr.o
	$(GHDL) -a $(GHDLFLAGS) $<

spr.o: processor/spr.vhd reg.o
	$(GHDL) -a $(GHDLFLAGS) $<

switch_reg.o: IO/switch_register.vhd
	$(GHDL) -a $(GHDLFLAGS) $<

txt_util.o: txt_util.vhd
	$(GHDL) -a $(GHDLFLAGS) $<

reg.o: processor/reg.vhd
	$(GHDL) -a $(GHDLFLAGS) $<
